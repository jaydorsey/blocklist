#!/usr/bin/env bash

url=`echo $1 | sed -e 's|^[^/]*//||' -e 's|/.*$||' -e 's|www\.||'`

echo "Adding $url";
echo "0.0.0.0 $url" >> hosts | sort -u hosts -o hosts
# Append
jq --arg value "$url" '."denied-remote-domains" |= . + [$value]' jaydorsey.lsrules > tmp.json && mv tmp.json jaydorsey.lsrules
# Sort & unique
jq '."denied-remote-domains" |= unique' jaydorsey.lsrules > tmp.json && mv tmp.json jaydorsey.lsrules
# cat jaydorsey.lsrules | jq '."denied-remote-domains" |= unique' jaydorsey.lsrules > jaydorsey.lsrules

echo "Added $url"
